<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover, interactive-widget=resizes-content">

<title>è›å…‰ãƒšãƒ³ PRO | å…è²»ç·šä¸Š SEOæ–‡æ¡ˆç·¨è¼¯å™¨ & é—œéµå­—æª¢æ¸¬å·¥å…·</title>
<meta name="description" content="2025 æœ€æ–° SEO æ–‡æ¡ˆå·¥å…·ã€‚æä¾›é—œéµå­—å¯†åº¦åˆ†æã€ä¸€éµ HTML æ¨™è¨»ã€Google Docs æ ¼å¼ç›¸å®¹ã€Zen Mode å°ˆæ³¨æ¨¡å¼ã€‚å…ä¸‹è¼‰ã€é›¢ç·šå¯ç”¨çš„ PWA æ•¸ä½æ–‡æˆ¿å…·ã€‚">
<meta name="keywords" content="SEOå·¥å…·, æ–‡æ¡ˆç·¨è¼¯å™¨, é—œéµå­—å¯†åº¦æª¢æŸ¥, PWA, é›¢ç·šå¯«ä½œ, æ•¸ä½æ–‡æˆ¿å…·, HTMLè½‰Word, è¢å…‰ç­†å·¥å…·">
<meta name="robots" content="index, follow">
<meta name="author" content="Kaoru Tsai">
<link rel="canonical" href="https://your-domain.com/fluo-pen-pro">

<meta property="og:title" content="è›å…‰ãƒšãƒ³ PRO | è·äººç´šSEOæ–‡æ¡ˆæ•¸ä½å·¥å…·">
<meta property="og:description" content="å°ˆç‚ºå…§å®¹å‰µä½œè€…è¨­è¨ˆçš„æ—¥ç³»æ•¸ä½æ–‡æˆ¿å…·ã€‚è®“æ‚¨çš„æ–‡å­—ç·¨è¼¯ã€é—œéµå­—åˆ†æèˆ‡æ’ç‰ˆå·¥ä½œæ›´å„ªé›…é«˜æ•ˆã€‚">
<meta property="og:type" content="website">
<meta property="og:site_name" content="è›å…‰ãƒšãƒ³ PRO">
<meta property="og:image" content="https://placehold.co/1200x630/2B4B65/FFF?text=Fluo+Pen+PRO">

<meta name="theme-color" content="#F9F8F4">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">

<script type="application/ld+json">
[
  {
    "@context": "https://schema.org",
    "@type": "SoftwareApplication",
    "name": "è›å…‰ãƒšãƒ³ PRO",
    "alternateName": "Fluo Pen PRO",
    "applicationCategory": "ProductivityApplication",
    "operatingSystem": "Any",
    "offers": { "@type": "Offer", "price": "0", "priceCurrency": "TWD" },
    "description": "å°ˆç‚º SEO æ–‡æ¡ˆèˆ‡å…§å®¹å‰µä½œè€…è¨­è¨ˆçš„è¼•é‡ç´š PWA ç·¨è¼¯å™¨ï¼Œå…·å‚™å³æ™‚é è¦½èˆ‡é—œéµå­—åˆ†æåŠŸèƒ½ã€‚",
    "featureList": [ "PWA é›¢ç·šä½¿ç”¨", "SEO é—œéµå­—å¯†åº¦å³æ™‚æª¢æ¸¬", "Google Docs æ ¼å¼å®Œç¾è²¼ä¸Š", "Zen Mode å°ˆæ³¨æ¨¡å¼" ],
    "author": { "@type": "Person", "name": "Kaoru Tsai" }
  },
  {
    "@context": "https://schema.org",
    "@type": "FAQPage",
    "mainEntity": [
      {
        "@type": "Question",
        "name": "å¦‚ä½•ä½¿ç”¨ Zen Mode (å°ˆæ³¨æ¨¡å¼)ï¼Ÿ",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "åœ¨é›»è…¦ç‰ˆä»‹é¢ä¸­ï¼Œé»æ“Šå·¥å…·åˆ—æœ€å·¦å´çš„åœ–ç¤ºï¼Œæˆ–ä½¿ç”¨å¿«æ·éµ Ctrl + \\ (Cmd + \\) å³å¯é–‹å•Ÿ Zen Modeï¼Œæ”¶åˆå´é‚Šæ¬„ä¸¦ç½®ä¸­ç·¨è¼¯å€ã€‚"
        }
      },
      {
        "@type": "Question",
        "name": "é€™æ¬¾å·¥å…·æ”¯æ´é›¢ç·šä½¿ç”¨å—ï¼Ÿ",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "æ”¯æ´ã€‚è›å…‰ãƒšãƒ³ PRO æ¡ç”¨ PWA æŠ€è¡“ï¼Œç¶²é è¼‰å…¥ä¸€æ¬¡å¾Œå³å¯åœ¨ç„¡ç¶²è·¯ç’°å¢ƒä¸‹ç¹¼çºŒç·¨è¼¯ï¼Œå…§å®¹æœƒæš«å­˜æ–¼ç€è¦½å™¨ä¸­ã€‚"
        }
      }
    ]
  }
]
</script>

<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&family=Shippori+Mincho:wght@500;700&family=Zen+Kaku+Gothic+New:wght@300;400;500;700&display=swap" rel="stylesheet">

<script>
  // åŸºç¤äº‹ä»¶æ””æˆª
  document.addEventListener('contextmenu', e => {
    const isEditable = e.target.closest('textarea, input, [contenteditable="true"]');
    if (isEditable) return; 
    e.preventDefault();      
  });
  document.addEventListener('keydown', e => {
    if((e.ctrlKey && ['s','S','u','U'].includes(e.key))){ e.preventDefault(); }
  });
  if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => { navigator.serviceWorker.register('./sw.js').catch(e => console.log('SW Fail')); });
  }
</script>

<style>
  :root {
    --bg-canvas: #F9F8F4; --bg-sidebar: #FFFFFF; --border-color: #E0E0E0;
    --c-ink: #333333; --c-sub: #666666; --c-accent: #2B4B65; --c-highlight: #BF1E33;
    --font-serif: 'Shippori Mincho', serif; --font-sans: 'Zen Kaku Gothic New', sans-serif; --font-editor: 'Noto Sans TC', sans-serif;
    
    --mobile-header-h: 48px;
    --mobile-nav-h: 50px;
  }
  [data-theme="dark"] {
    --bg-canvas: #202020; --bg-sidebar: #2B2B2B; --border-color: #3E3E3E;
    --c-ink: #E6E6E6; --c-sub: #9E9E9E; --c-accent: #7DA3C2; --c-highlight: #D47070;
  }

  html, body { 
    background: var(--bg-canvas); color: var(--c-ink); font-family: var(--font-sans); 
    height: 100dvh; width: 100%; overflow: hidden; overscroll-behavior: none; 
    display: flex; flex-direction: column; transition: background 0.3s, color 0.3s; 
    position: fixed; top: 0; left: 0;
  }

  .bg-grid { position: fixed; inset: 0; background-image: linear-gradient(#E5E5E5 1px, transparent 1px), linear-gradient(90deg, #E5E5E5 1px, transparent 1px); background-size: 24px 24px; opacity: 0.5; pointer-events: none; z-index: 0; }
  [data-theme="dark"] .bg-grid { opacity: 0.05; background-image: linear-gradient(#666 1px, transparent 1px), linear-gradient(90deg, #666 1px, transparent 1px); }

  .custom-scroll::-webkit-scrollbar { width: 4px; height: 4px; }
  .custom-scroll::-webkit-scrollbar-thumb { background: #CCC; border-radius: 2px; }
  [data-theme="dark"] .custom-scroll::-webkit-scrollbar-thumb { background: #555; }

  .sidebar { 
    background: var(--bg-sidebar); border-right: 1px solid var(--border-color); 
    display: flex; flex-direction: column; z-index: 20; box-shadow: 2px 0 15px rgba(0,0,0,0.03); 
    transition: margin-left 0.4s cubic-bezier(0.25, 0.8, 0.25, 1), opacity 0.3s; 
  }

  .input-area { width: 100%; background: var(--bg-canvas); border: 1px solid var(--border-color); border-radius: 4px; padding: 12px; font-size: 14px; font-family: var(--font-sans); resize: none; outline: none; transition: 0.2s; line-height: 1.6; color: var(--c-ink); }
  .input-area:focus { border-color: var(--c-accent); background: var(--bg-sidebar); box-shadow: 0 2px 8px rgba(0,0,0, 0.1); }
  
  .density-panel { background: var(--bg-canvas); border: 1px solid var(--border-color); border-radius: 6px; padding: 8px; margin-bottom: 10px; max-height: 120px; overflow-y: auto; display: flex; flex-wrap: wrap; gap: 6px; }
  .kw-tag { font-size: 11px; padding: 2px 8px; border-radius: 4px; background: var(--bg-sidebar); border: 1px solid var(--border-color); color: var(--c-sub); display: flex; align-items: center; gap: 4px; cursor: default; }
  .kw-tag .count { font-weight: 800; color: var(--c-accent); }
  .kw-tag.good { border-color: #C6F6D5; background: #F0FFF4; color: #276749; }
  .kw-tag.missing { border-color: #FECACA; background: #FFF5F5; color: #C9171E; }
  [data-theme="dark"] .kw-tag.good { background: #1C3325; border-color: #276749; color: #81E6D9; }
  [data-theme="dark"] .kw-tag.missing { background: #3B1C1C; border-color: #742A2A; color: #FC8181; }

  .preview-container { flex: 1; display: flex; flex-direction: column; position: relative; overflow: hidden; z-index: 10; transition: all 0.4s; }
  
  .toolbar { 
    background: var(--bg-sidebar); border-bottom: 1px solid var(--border-color); 
    padding: 8px 16px; display: flex; align-items: center; gap: 8px; 
    overflow-x: auto; white-space: nowrap; z-index: 30; transition: background 0.3s;
    flex-wrap: nowrap !important; flex-shrink: 0; height: 50px; position: relative;
  }

  .tool-btn { 
    display: flex; align-items: center; justify-content: center; 
    height: 32px; min-width: 32px; padding: 0 6px; 
    border-radius: 4px; color: var(--c-sub); 
    font-size: 13px; font-family: var(--font-serif); font-weight: 500; 
    cursor: pointer; border: 1px solid transparent; flex-shrink: 0; 
    position: relative; 
  }
  .tool-btn:hover { background: var(--bg-canvas); color: var(--c-accent); border-color: var(--border-color); }
  
  /* UX: Tooltip å„ªåŒ– */
  @media (min-width: 769px) {
    .tool-btn[data-tooltip]:hover::after {
      content: attr(data-tooltip);
      position: absolute; top: 100%; left: 50%; transform: translateX(-50%);
      background: #2B4B65; color: white; padding: 4px 8px; font-size: 10px; border-radius: 4px;
      white-space: nowrap; pointer-events: none; z-index: 100; margin-top: 6px; opacity: 0; 
      animation: tooltipFade 0.2s forwards 0.3s; font-family: var(--font-sans); box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }
  }
  @keyframes tooltipFade { to { opacity: 1; } }

  .tool-sep { width: 1px; height: 20px; background: var(--border-color); flex-shrink: 0; margin: 0 2px; }
  .color-dot { width: 18px; height: 18px; border-radius: 50%; cursor: pointer; border: 2px solid var(--bg-sidebar); box-shadow: 0 0 0 1px var(--border-color); flex-shrink: 0; display: flex; align-items: center; justify-content: center; }
  .color-none { border: 1px solid var(--c-sub); background: transparent; }
  .color-none svg { width: 10px; height: 10px; color: var(--c-sub); }

  .mobile-scroll-area.editor-container {
    flex: 1; overflow-y: auto; -webkit-overflow-scrolling: touch; height: 100%; position: relative;
    background: #F0F0F0;
  }
  [data-theme="dark"] .mobile-scroll-area.editor-container { background: #1a1a1a; }

  /* UX: Depth UI (æ“¬çœŸç´™å¼µ) */
  .editor-paper { 
    width: 100%; max-width: 800px; min-height: calc(100% - 40px); margin: 20px auto; 
    background: var(--bg-sidebar); padding: 60px 80px; 
    outline: none; font-family: var(--font-editor); font-size: 12pt; font-weight: 400; 
    line-height: 1.6; color: var(--c-ink); text-align: left; transition: all 0.3s; 
    box-shadow: 0 1px 1px rgba(0,0,0,0.02), 0 2px 2px rgba(0,0,0,0.02), 0 4px 4px rgba(0,0,0,0.02), 0 8px 16px rgba(0,0,0,0.04);
  }
  
  .editor-paper h2 { font-family: var(--font-serif); font-size: 18pt; font-weight: 700; color: var(--c-accent); border-bottom: 1px solid var(--border-color); padding-bottom: 6px; margin: 24px 0 12px 0; display: block; line-height: 1.4; }
  .editor-paper h3 { font-family: var(--font-serif); font-size: 14pt; font-weight: 700; color: var(--c-ink); border-left: 4px solid var(--c-highlight); padding-left: 10px; margin: 18px 0 10px 0; display: block; line-height: 1.4; }
  .editor-paper p { margin-bottom: 12pt; display: block; }
  .editor-paper ul { list-style-type: disc; padding-left: 2em; margin-bottom: 12pt; }
  .editor-paper ol { list-style-type: decimal; padding-left: 2em; margin-bottom: 12pt; }
  
  .highlight-pulse { background-color: rgba(255, 255, 0, 0.4); box-shadow: 0 0 8px rgba(255, 255, 0, 0.6); }
  [data-theme="dark"] .highlight-pulse { background-color: rgba(255, 215, 0, 0.2); }

  .stats-bar { background: var(--bg-sidebar); border-top: 1px solid var(--border-color); padding: 8px 20px; font-size: 11px; color: var(--c-sub); display: flex; justify-content: space-between; align-items: center; transition: background 0.3s; flex-shrink: 0; height: 40px; }
  .floating-menu { position: fixed; z-index: 999; background: var(--bg-sidebar); border: 1px solid var(--border-color); border-radius: 50px; padding: 6px 12px; display: flex; gap: 8px; box-shadow: 0 4px 20px rgba(0,0,0,0.15); opacity: 0; pointer-events: none; transform: translateY(10px); transition: 0.2s; }
  .floating-menu.show { opacity: 1; pointer-events: auto; transform: translateY(0); }

  /* UX: Toast Notification Style */
  .toast-container { position: fixed; bottom: 80px; left: 50%; transform: translateX(-50%); z-index: 1000; pointer-events: none; display: flex; flex-direction: column; gap: 8px; }
  .toast { background: rgba(0,0,0,0.8); color: white; padding: 8px 16px; border-radius: 8px; font-size: 13px; font-family: var(--font-sans); opacity: 0; transform: translateY(10px); transition: 0.3s; box-shadow: 0 4px 12px rgba(0,0,0,0.15); display: flex; align-items: center; gap: 6px; }
  .toast.show { opacity: 1; transform: translateY(0); }
  [data-theme="dark"] .toast { background: rgba(255,255,255,0.9); color: #222; }

  /* SEO/AI Content: Visually Hidden but readable by bots */
  .seo-content { 
      position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0,0,0,0); white-space: nowrap; border: 0;
  }
  
  /* Zen Mode */
  @media (min-width: 769px) {
    body.zen-mode .sidebar { margin-left: -320px; opacity: 0; pointer-events: none; }
    body.zen-mode .sidebar.lg\:w-\[360px\] { margin-left: -360px; }
    body.zen-mode .editor-paper { transform: scale(1.02); box-shadow: 0 10px 40px rgba(0,0,0,0.08); }
    body.zen-mode .mobile-scroll-area.editor-container { background: var(--bg-canvas); }
  }

  @media (max-width: 768px) {
    .sidebar { width: 100% !important; border-right: none; position: fixed; top: var(--mobile-header-h); bottom: var(--mobile-nav-h); height: auto !important; }
    .preview-container { position: fixed; top: var(--mobile-header-h); bottom: var(--mobile-nav-h); width: 100%; height: auto !important; z-index: 10; }
    .editor-paper { padding: 20px 16px; width: 100%; box-shadow: none; min-height: 100%; margin: 0; }
    .toolbar { padding: 8px 10px; overflow-x: auto; -webkit-overflow-scrolling: touch; }
    .mobile-scroll-area { flex: 1; overflow-y: auto; -webkit-overflow-scrolling: touch; height: 100%; padding-bottom: 20px; }
    .sidebar.hidden-mobile { display: none !important; }
    .preview-container.hidden-mobile { display: none !important; }
    .sidebar.flex-mobile { display: flex !important; }
    .preview-container.flex-mobile { display: flex !important; }
    .zen-toggle-btn { display: none !important; }
    .toast-container { bottom: 60px; } /* Adjust for mobile nav */
  }

  .mobile-tab-bar { position: fixed; bottom: 0; left: 0; right: 0; height: var(--mobile-nav-h); background: var(--bg-sidebar); border-top: 1px solid var(--border-color); z-index: 50; justify-content: space-around; align-items: center; display: none; padding-bottom: env(safe-area-inset-bottom); transition: background 0.3s; }
  @media (max-width: 768px) { .mobile-tab-bar { display: flex; } }
  
  .tab-btn { flex: 1; height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; font-size: 10px; color: var(--c-sub); font-family: var(--font-serif); }
  .tab-btn.active { color: var(--c-highlight); font-weight: bold; background: rgba(0,0,0,0.02); }
  [data-theme="dark"] .tab-btn.active { background: rgba(255,255,255,0.05); }
</style>
</head>
<body>
  <div class="bg-grid"></div>

  <article class="seo-content">
      <h1>è›å…‰ãƒšãƒ³ PRO - SEO æ–‡æ¡ˆç·¨è¼¯å™¨</h1>
      <p>è›å…‰ãƒšãƒ³ PRO (Fluo Pen PRO) æ˜¯ä¸€æ¬¾å°ˆç‚º SEO å…§å®¹å‰µä½œè€…è¨­è¨ˆçš„ç·šä¸Šå·¥å…·ã€‚</p>
      <section>
          <h2>ä¸»è¦åŠŸèƒ½</h2>
          <ul>
              <li><strong>å³æ™‚ SEO æª¢æ¸¬</strong>ï¼šè¼¸å…¥ç›®æ¨™é—œéµå­—ï¼Œå³æ™‚è¨ˆç®—é—œéµå­—å¯†åº¦ã€‚</li>
              <li><strong>HTML è½‰ Docs</strong>ï¼šä¸€éµè¤‡è£½ä¸¦ä¿ç•™ H2/H3/ç²—é«”/é¡è‰²æ ¼å¼è²¼ä¸Š Google Docs æˆ– WordPressã€‚</li>
              <li><strong>Zen Mode</strong>ï¼šä¸€éµæ”¶åˆå´é‚Šæ¬„ï¼Œæä¾›ç„¡å¹²æ“¾çš„æ²‰æµ¸å¼å¯«ä½œé«”é©—ã€‚</li>
              <li><strong>PWA é›¢ç·šå¯«ä½œ</strong>ï¼šæ”¯æ´é›¢ç·šä½¿ç”¨ï¼Œç„¡éœ€å®‰è£è»Ÿé«”ã€‚</li>
          </ul>
      </section>
      <section>
          <h2>å¦‚ä½•ä½¿ç”¨</h2>
          <ol>
              <li>åœ¨å·¦å´ã€ŒåŸæ–‡è¼¸å…¥ã€è²¼ä¸Šæˆ–æ’°å¯«æ–‡ç« ã€‚</li>
              <li>è¼¸å…¥ã€ŒSEO é—œéµå­—ã€ä»¥é€²è¡Œå¯†åº¦åˆ†æã€‚</li>
              <li>é»æ“Šã€Œä¸€éµæ¨™è¨»ã€è‡ªå‹•å°‡æ–‡ç« ä¸­çš„é—œéµå­—æ¨™è¨˜ç‚ºç´…è‰²ã€‚</li>
              <li>åœ¨å³å´é è¦½å€ä½¿ç”¨å·¥å…·åˆ—èª¿æ•´æ’ç‰ˆï¼ˆH2, H3, åˆ—è¡¨, ç¸®æ’ï¼‰ã€‚</li>
          </ol>
      </section>
  </article>

  <header class="h-12 md:hidden flex items-center justify-between px-4 bg-[var(--bg-sidebar)] border-b border-[var(--border-color)] fixed top-0 left-0 right-0 z-40 shrink-0 transition-colors duration-300">
    <div class="flex items-center gap-2 font-serif text-[var(--c-ink)]">
      <svg class="w-5 h-5" viewBox="0 0 512 512" fill="none" stroke="currentColor" stroke-width="20"><path d="M256 86C256 86 160 190 160 310C160 380 200 426 256 426C312 426 352 380 352 310C352 190 256 86 256 86Z" stroke='currentColor' stroke-width='24' stroke-linecap='round' stroke-linejoin='round'/><path d='M256 180V320' stroke='currentColor' stroke-width='24' stroke-linecap='round'/><circle cx='256' cy='370' r='24' fill='var(--c-highlight)' stroke="none"/></svg>
      <span>è›å…‰ãƒšãƒ³</span>
    </div>
    <button onclick="App.UI.toggleTheme()"><svg class="w-5 h-5 text-[var(--c-sub)]" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg></button>
  </header>

  <div id="toastContainer" class="toast-container"></div>

  <div id="mobileFloatMenu" class="floating-menu">
     <div onmousedown="event.preventDefault()" onclick="App.Format.removeHighlight()" class="color-dot color-none"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6L6 18M6 6l12 12"/></svg></div>
     <div onmousedown="event.preventDefault()" onclick="App.Format.highlight('#F0DC70')" class="color-dot bg-[#F0DC70]"></div>
     <div class="w-[1px] h-4 bg-gray-200 opacity-50"></div>
     <div onmousedown="event.preventDefault()" onclick="App.Format.removeColor()" class="color-dot color-none"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6L6 18M6 6l12 12"/></svg></div>
     <div onmousedown="event.preventDefault()" onclick="App.Format.color('#BF1E33')" class="color-dot bg-[#BF1E33]"></div>
     <div class="w-[1px] h-4 bg-gray-200 opacity-50"></div>
     <button onmousedown="event.preventDefault()" onclick="App.Format.remove()" class="text-[var(--c-sub)]"><svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6L6 18M6 6l12 12"/></svg></button>
  </div>

  <div class="flex-1 flex overflow-hidden relative w-full h-full pt-12 md:pt-0">
    <aside id="tabInput" class="sidebar flex-mobile w-full md:w-[320px] lg:w-[360px] custom-scroll bg-[var(--bg-sidebar)] z-20 border-r border-[var(--border-color)]">
      <div class="mobile-scroll-area p-5 flex flex-col gap-4">
          <div class="flex items-center justify-between mb-2">
            <div class="flex items-center gap-3">
              <svg class="w-8 h-8 text-[var(--c-accent)] hidden md:block" viewBox="0 0 512 512" fill="none" stroke="currentColor" stroke-width="20"><path d="M256 86C256 86 160 190 160 310C160 380 200 426 256 426C312 426 352 380 352 310C352 190 256 86 256 86Z" stroke='currentColor' stroke-width='24' stroke-linecap='round' stroke-linejoin='round'/><path d='M256 180V320' stroke='currentColor' stroke-width='24' stroke-linecap='round'/><circle cx='256' cy='370' r='24' fill='var(--c-highlight)' stroke="none"/></svg>
              <div class="hidden md:block">
                <h1 class="text-lg font-bold font-serif">è›å…‰ãƒšãƒ³ <span class="text-xs text-[var(--c-highlight)] font-sans">PRO</span></h1>
                <p class="text-[9px] tracking-widest opacity-60">DIGITAL STATIONERY v8.7</p>
              </div>
            </div>
            <button onclick="App.UI.toggleTheme()" class="text-[var(--c-sub)] hover:text-[var(--c-accent)] hidden md:block" title="åˆ‡æ›æ·±è‰²æ¨¡å¼">
               <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
            </button>
          </div>

          <div>
            <div class="flex justify-between items-baseline mb-2">
              <h3 class="font-serif font-bold text-sm border-l-4 border-[var(--c-accent)] pl-2">åŸæ–‡è¼¸å…¥</h3>
              <button onclick="App.Core.restore()" class="text-[10px] text-blue-500 hover:underline font-serif">é‚„åŸ</button>
            </div>
            <textarea id="sourceText" class="input-area h-48" placeholder="åœ¨æ­¤è²¼ä¸Šæ–‡ç« ..."></textarea>
          </div>

          <div>
            <h3 class="font-serif font-bold text-sm border-l-4 border-[var(--c-highlight)] pl-2 mb-2">SEO é—œéµå­—</h3>
            <textarea id="kwList" class="input-area h-20 mb-2" placeholder="é—œéµå­— (ä¸€è¡Œä¸€å€‹)"></textarea>
            <div id="densityPanel" class="density-panel custom-scroll"><span class="text-xs text-gray-400 w-full text-center py-2">ç­‰å¾…è¼¸å…¥...</span></div>
          </div>

          <div class="mt-4 space-y-3 pb-8">
            <button onclick="App.Core.forceSync()" class="w-full py-3 bg-[var(--c-highlight)] text-white font-bold rounded shadow-md hover:opacity-90 transition text-sm font-serif tracking-wide">âŸ³ ä¸€éµæ¨™è¨» (Sync & Check)</button>
            <button onclick="App.Core.copyToDocs()" class="w-full py-2 border border-[var(--c-accent)] text-[var(--c-accent)] rounded hover:bg-blue-50 hover:bg-opacity-10 transition text-sm flex justify-center items-center gap-2 font-serif"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"/></svg> è¤‡è£½åˆ° Docs (æ ¼å¼é–å®š)</button>
            <div class="grid grid-cols-2 gap-2 pt-2 border-t border-[var(--border-color)]">
               <button onclick="App.Storage.clear('source')" class="py-1 text-xs text-gray-500 border border-gray-200 hover:border-red-500 rounded hover:text-red-500 font-serif transition">æ¸…ç©ºåŸæ–‡</button>
               <button onclick="App.Storage.clear('kw')" class="py-1 text-xs text-gray-500 border border-gray-200 hover:border-red-500 rounded hover:text-red-500 font-serif transition">æ¸…ç©ºé—œéµå­—</button>
               <button onclick="App.Storage.download('html')" class="py-1 text-xs text-[var(--c-accent)] border border-[var(--c-accent)] rounded hover:bg-[var(--c-accent)] hover:text-white transition font-serif">å‚™ä»½ HTML</button>
               <button onclick="App.Storage.download('doc')" class="py-1 text-xs text-[var(--c-accent)] border border-[var(--c-accent)] rounded hover:bg-[var(--c-accent)] hover:text-white transition font-serif">å‚™ä»½ Word</button>
               <button onclick="App.Storage.clear('all')" class="col-span-2 py-2 text-xs text-white bg-gray-400 rounded hover:bg-red-500 transition font-serif">å…¨éƒ¨é‡ç½® (å±éšª)</button>
            </div>
            <p class="text-[9px] text-center text-[var(--c-sub)] mt-2 font-serif opacity-60">Production by Kaoru Tsai Â© 2025</p>
          </div>
      </div>
    </aside>

    <main id="tabPreview" class="preview-container hidden-mobile w-full h-full flex flex-col">
      <div class="toolbar custom-scroll shrink-0">
        <button onmousedown="event.preventDefault()" onclick="App.UI.toggleZenMode()" class="tool-btn zen-toggle-btn border-r border-[var(--border-color)] mr-2 pr-3" data-tooltip="å°ˆæ³¨æ¨¡å¼ (Cmd+\)"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg></button>
        
        <button onmousedown="event.preventDefault()" onclick="document.execCommand('undo')" class="tool-btn" data-tooltip="å¾©åŸ (Ctrl+Z)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M3 7v6h6"/><path d="M21 17a9 9 0 00-9-9 9 9 0 00-6 2.3L3 13"/></svg></button>
        <button onmousedown="event.preventDefault()" onclick="document.execCommand('redo')" class="tool-btn" data-tooltip="é‡åš (Ctrl+Y)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M21 7v6h-6"/><path d="M3 17a9 9 0 019-9 9 9 0 016 2.3l6 3.7"/></svg></button>
        <div class="tool-sep"></div>
        <button onmousedown="event.preventDefault()" onclick="document.execCommand('bold')" class="tool-btn font-serif font-bold text-lg" data-tooltip="ç²—é«” (Ctrl+B)">B</button>
        <button onmousedown="event.preventDefault()" onclick="document.execCommand('italic')" class="tool-btn font-serif italic text-lg" data-tooltip="æ–œé«” (Ctrl+I)">I</button>
        <button onmousedown="event.preventDefault()" onclick="document.execCommand('underline')" class="tool-btn font-serif underline text-lg" data-tooltip="åº•ç·š (Ctrl+U)">U</button>
        <div class="tool-sep"></div>
        <button onmousedown="event.preventDefault()" onclick="App.Format.cmd('formatBlock','h2')" class="tool-btn font-bold text-lg font-serif" data-tooltip="å¤§æ¨™é¡Œ H2">H2</button>
        <button onmousedown="event.preventDefault()" onclick="App.Format.cmd('formatBlock','h3')" class="tool-btn font-bold text-base font-serif" data-tooltip="ä¸­æ¨™é¡Œ H3">H3</button>
        <button onmousedown="event.preventDefault()" onclick="App.Format.cmd('formatBlock','p')" class="tool-btn font-serif" data-tooltip="å…§æ–‡ P">P</button>
        
        <div class="tool-sep"></div>
        <button onmousedown="event.preventDefault()" onclick="document.execCommand('justifyLeft')" class="tool-btn" data-tooltip="é å·¦å°é½Š"><svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="21" y1="10" x2="3" y2="10"></line><line x1="21" y1="6" x2="3" y2="6"></line><line x1="21" y1="14" x2="3" y2="14"></line><line x1="21" y1="18" x2="3" y2="18"></line></svg></button>
        <button onmousedown="event.preventDefault()" onclick="document.execCommand('justifyCenter')" class="tool-btn" data-tooltip="ç½®ä¸­å°é½Š"><svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="21" y1="10" x2="3" y2="10"></line><line x1="18" y1="6" x2="6" y2="6"></line><line x1="21" y1="14" x2="3" y2="14"></line><line x1="18" y1="18" x2="6" y2="18"></line></svg></button>
        <button onmousedown="event.preventDefault()" onclick="document.execCommand('justifyRight')" class="tool-btn" data-tooltip="é å³å°é½Š"><svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="21" y1="10" x2="3" y2="10"></line><line x1="21" y1="6" x2="3" y2="6"></line><line x1="21" y1="14" x2="3" y2="14"></line><line x1="21" y1="18" x2="3" y2="18"></line></svg></button>
        <div class="tool-sep"></div>
        <button onmousedown="event.preventDefault()" onclick="document.execCommand('insertUnorderedList')" class="tool-btn" data-tooltip="é …ç›®ç¬¦è™Ÿ"><svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="21" y1="10" x2="9" y2="10"></line><line x1="21" y1="6" x2="9" y2="6"></line><line x1="21" y1="14" x2="9" y2="14"></line><line x1="21" y1="18" x2="9" y2="18"></line><circle cx="4" cy="6" r="2" fill="currentColor" stroke="none"/><circle cx="4" cy="10" r="2" fill="currentColor" stroke="none"/><circle cx="4" cy="14" r="2" fill="currentColor" stroke="none"/><circle cx="4" cy="18" r="2" fill="currentColor" stroke="none"/></svg></button>
        <button onmousedown="event.preventDefault()" onclick="document.execCommand('insertOrderedList')" class="tool-btn" data-tooltip="ç·¨è™Ÿæ¸…å–®"><svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="21" y1="10" x2="9" y2="10"></line><line x1="21" y1="6" x2="9" y2="6"></line><line x1="21" y1="14" x2="9" y2="14"></line><line x1="21" y1="18" x2="9" y2="18"></line><path d="M4 6h2" /><path d="M4 10h2" /><path d="M4 14h2" /></svg></button>
        <div class="tool-sep"></div>
        <button onmousedown="event.preventDefault()" onclick="document.execCommand('outdent')" class="tool-btn" data-tooltip="æ¸›å°‘ç¸®æ’"><svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="7 8 3 12 7 16"></polyline><line x1="21" y1="12" x2="3" y2="12"></line><line x1="21" y1="6" x2="11" y2="6"></line><line x1="21" y1="18" x2="11" y2="18"></line></svg></button>
        <button onmousedown="event.preventDefault()" onclick="document.execCommand('indent')" class="tool-btn" data-tooltip="å¢åŠ ç¸®æ’"><svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="17 8 21 12 17 16"></polyline><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="13" y2="6"></line><line x1="3" y1="18" x2="13" y2="18"></line></svg></button>

        <div class="tool-sep"></div>
        <div class="flex items-center gap-1 flex-shrink-0">
            <button onmousedown="event.preventDefault()" onclick="App.Format.stepSize(-1)" class="tool-btn font-serif text-sm px-1" data-tooltip="ç¸®å°å­—é«”">A-</button>
            <select id="fontSizeSelect" onchange="App.Format.setSize(this.value)" class="h-8 border border-[var(--border-color)] rounded text-xs bg-[var(--bg-sidebar)] px-1 outline-none font-sans w-12 text-center text-[var(--c-ink)]">
              <option value="10pt">10</option><option value="11pt">11</option><option value="12pt" selected>12</option><option value="14pt">14</option><option value="16pt">16</option><option value="18pt">18</option><option value="20pt">20</option><option value="24pt">24</option><option value="28pt">28</option><option value="36pt">36</option><option value="48pt">48</option><option value="72pt">72</option>
            </select>
            <button onmousedown="event.preventDefault()" onclick="App.Format.stepSize(1)" class="tool-btn font-serif text-lg px-1" data-tooltip="æ”¾å¤§å­—é«”">A+</button>
        </div>
        <div class="tool-sep"></div>
        <div class="flex gap-2 px-1 flex-shrink-0">
          <div onmousedown="event.preventDefault()" onclick="App.Format.removeColor()" class="color-dot color-none" data-tooltip="é è¨­æ–‡å­—è‰²"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6L6 18M6 6l12 12"/></svg></div>
          <div onmousedown="event.preventDefault()" onclick="App.Format.color('#333333')" class="color-dot bg-[#333333]"></div>
          <div onmousedown="event.preventDefault()" onclick="App.Format.color('#2B4B65')" class="color-dot bg-[#2B4B65]"></div>
          <div onmousedown="event.preventDefault()" onclick="App.Format.color('#BF1E33')" class="color-dot bg-[#BF1E33]"></div>
          <div onmousedown="event.preventDefault()" onclick="App.Format.color('#2F5D50')" class="color-dot bg-[#2F5D50]"></div>
          <div onmousedown="event.preventDefault()" onclick="App.Format.color('#6A4C9C')" class="color-dot bg-[#6A4C9C]"></div>
        </div>
        <div class="tool-sep"></div>
        <div class="flex gap-2 px-1 flex-shrink-0">
          <div onmousedown="event.preventDefault()" onclick="App.Format.removeHighlight()" class="color-dot color-none" data-tooltip="ç„¡è¢å…‰ç­†"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6L6 18M6 6l12 12"/></svg></div>
          <div onmousedown="event.preventDefault()" onclick="App.Format.highlight('#F0DC70')" class="color-dot bg-[#F0DC70]"></div>
          <div onmousedown="event.preventDefault()" onclick="App.Format.highlight('#F5B199')" class="color-dot bg-[#F5B199]"></div>
          <div onmousedown="event.preventDefault()" onclick="App.Format.highlight('#A0D8EF')" class="color-dot bg-[#A0D8EF]"></div>
          <div onmousedown="event.preventDefault()" onclick="App.Format.highlight('#C6Eac5')" class="color-dot bg-[#C6Eac5]"></div>
          <div onmousedown="event.preventDefault()" onclick="App.Format.highlight('#E0C8F2')" class="color-dot bg-[#E0C8F2]"></div>
        </div>
        <div class="tool-sep"></div>
        <button onmousedown="event.preventDefault()" onclick="App.Format.remove()" class="tool-btn" data-tooltip="æ¸…é™¤æ ¼å¼"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M18 6L6 18M6 6l12 12"/></svg></button>
      </div>

      <div class="mobile-scroll-area editor-container custom-scroll">
        <div id="editor" contenteditable="true" class="editor-paper shadow-lg" spellcheck="false" placeholder="ç­‰å¾…åŒæ­¥..."></div>
      </div>

      <div class="stats-bar shrink-0">
        <div class="flex gap-4">
          <span id="saveStatus" class="text-[var(--c-highlight)] font-bold opacity-0 transition-opacity">å·²å„²å­˜</span>
          <span>å­—æ•¸: <b id="countTotal">0</b></span>
          <span id="selCountGroup" class="opacity-50">é¸å–: <b id="countSel">0</b></span>
        </div>
        <button id="btnPunc" onclick="App.UI.togglePunctuation()" class="flex items-center gap-1 text-xs px-2 py-1 rounded border hover:bg-gray-100 dark:hover:bg-gray-700 transition">
          <span class="w-2 h-2 rounded-full bg-green-500" id="puncDot"></span> å«æ¨™é»
        </button>
      </div>
    </main>
  </div>

  <nav class="mobile-tab-bar">
    <button onclick="App.UI.switchMobileTab('input')" class="tab-btn active" id="tabBtnInput">ç·¨è¼¯ä¾†æº</button>
    <button onclick="App.UI.switchMobileTab('preview')" class="tab-btn" id="tabBtnPreview">å³æ™‚é è¦½</button>
  </nav>

  <script>
    const Config = {
        colors: { '#333333': '#333333', '#2B4B65': '#2B4B65', '#BF1E33': '#BF1E33', '#2F5D50': '#2F5D50', '#6A4C9C': '#6A4C9C', 'var(--c-ink)': '#333333', 'var(--c-accent)': '#2B4B65', 'var(--c-highlight)': '#BF1E33' },
        fontScale: [10, 11, 12, 14, 16, 18, 20, 24, 28, 36, 48, 72]
    };

    const App = {
        state: { isAutoSync: true, includePunctuation: true },
        Storage: {
            save: (key, val) => { localStorage.setItem(key, val); App.UI.showSaved(); },
            get: (key) => localStorage.getItem(key),
            clear: (type) => { 
                if(!confirm('ç¢ºå®šæ¸…é™¤ï¼Ÿæ­¤å‹•ä½œç„¡æ³•å¾©åŸã€‚')) return;
                if(type === 'source') { document.getElementById('sourceText').value = ''; App.Storage.save('fluo_src', ''); }
                if(type === 'kw') { document.getElementById('kwList').value = ''; App.Storage.save('fluo_kw', ''); }
                if(type === 'all') { document.getElementById('sourceText').value = ''; document.getElementById('kwList').value = ''; document.getElementById('editor').innerHTML = ''; localStorage.clear(); }
                App.Core.smartHighlight();
            },
            download: (format) => { 
                const content = document.getElementById('editor').innerHTML;
                const style = `body { font-family: 'Shippori Mincho', sans-serif; margin: 20px auto; padding: 40px; color: #333; line-height: 1.6; } h2 { font-size: 18pt; color: #2B4B65; border-bottom: 1px solid #DDD; } h3 { font-size: 14pt; border-left: 4px solid #BF1E33; padding-left: 10px; }`;
                const fullHtml = `<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'><head><meta charset='utf-8'><title>Backup</title><style>${style}</style></head><body>${content}</body></html>`;
                const blob = new Blob([fullHtml], { type: format === 'doc' ? 'application/msword' : 'text/html' });
                const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = `fluo_backup_${new Date().toISOString().slice(0,10)}.${format}`; document.body.appendChild(a); a.click(); document.body.removeChild(a);
            }
        },
        Init: () => {
            App.Dom = { source: document.getElementById('sourceText'), kw: document.getElementById('kwList'), editor: document.getElementById('editor'), density: document.getElementById('densityPanel'), countTotal: document.getElementById('countTotal'), countSel: document.getElementById('countSel'), puncDot: document.getElementById('puncDot'), saveStatus: document.getElementById('saveStatus'), fontSelect: document.getElementById('fontSizeSelect') };
            if(localStorage.getItem('fluo_theme') === 'dark') document.body.setAttribute('data-theme', 'dark');
            if(App.Storage.get('fluo_src')) App.Dom.source.value = App.Storage.get('fluo_src');
            if(App.Storage.get('fluo_kw')) App.Dom.kw.value = App.Storage.get('fluo_kw');
            const savedHtml = App.Storage.get('fluo_temp');
            if(savedHtml && savedHtml.trim().length > 0) { App.Dom.editor.innerHTML = savedHtml; App.state.isAutoSync = false; App.Core.analyzeDensity(); } else { App.Core.runSync(); }
            
            if(localStorage.getItem('fluo_zen') === 'true') { document.body.classList.add('zen-mode'); }
            
            document.addEventListener('keydown', e => {
                if ((e.metaKey || e.ctrlKey) && e.key === '\\') { 
                    e.preventDefault(); App.UI.toggleZenMode(); 
                }
            });

            let debounceTimer;
            App.Dom.source.addEventListener('input', () => { 
                clearTimeout(debounceTimer);
                debounceTimer = setTimeout(() => {
                    App.state.isAutoSync=true; 
                    App.Core.runSync(); 
                }, 500);
            });

            App.Dom.kw.addEventListener('input', () => { App.Core.analyzeDensity(); App.Storage.save('fluo_kw', App.Dom.kw.value); });
            App.Dom.editor.addEventListener('input', () => { App.state.isAutoSync=false; App.UI.updateStats(); App.Storage.save('fluo_temp', App.Dom.editor.innerHTML); });
            
            App.Dom.editor.addEventListener('copy', (e) => { App.Core.handleManualCopy(e); });

            document.addEventListener('selectionchange', () => { App.UI.updateStats(); const sel = window.getSelection(); if(sel.rangeCount > 0 && !sel.isCollapsed) { let p = sel.anchorNode.parentElement; if(p.tagName!=='SPAN') p=p.closest('span'); if(p&&p.style.fontSize) App.Dom.fontSelect.value = p.style.fontSize; }});
        },
        Core: {
            runSync: () => {
                if(!App.state.isAutoSync) return;
                const raw = App.Dom.source.value; const safeText = raw.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;");
                const html = safeText.split('\n').map(line => line.trim() ? `<p>${line}</p>` : '<p><br></p>').join('');
                if (App.Dom.editor.innerHTML !== html) {
                    App.Dom.editor.innerHTML = html || '<p class="text-gray-300">è«‹åœ¨å·¦å´è¼¸å…¥æ–‡å­—...</p>';
                    App.Core.smartHighlight(); 
                }
                App.Storage.save('fluo_src', raw);
            },
            analyzeDensity: () => {
                const text = App.Dom.source.value; const kws = App.Dom.kw.value.split('\n').filter(k => k.trim());
                if(kws.length === 0) { App.Dom.density.innerHTML = '<span class="text-xs text-gray-400 w-full text-center py-2">ç„¡é—œéµå­—</span>'; return; }
                let html = '';
                kws.forEach(kw => { const count = (text.match(new RegExp(kw, 'gi'))||[]).length; const d = (text.length>0)?((count*kw.length/text.length)*100).toFixed(1):0; let cls=count===0?'missing':(d>0.5&&d<5?'good':''); html += `<div class="kw-tag ${cls}">${kw} <span class="count">${count}</span> <span style="opacity:0.6">(${d}%)</span></div>`; });
                App.Dom.density.innerHTML = html;
            },
            forceSync: () => {
                const editorEmpty = !App.Dom.editor.innerText.trim();
                const sourceHasText = App.Dom.source.value.trim().length > 0;
                if (editorEmpty && sourceHasText) { App.state.isAutoSync = true; App.Core.runSync(); App.UI.toast('âœ¨ å·²å¾åŸæ–‡åŒæ­¥ä¸¦æ¨™è¨»ï¼'); } 
                else { App.Core.smartHighlight(); const kws = App.Dom.kw.value.trim(); if(!kws) App.UI.toast('âš ï¸ è«‹å…ˆè¼¸å…¥é—œéµå­—'); else App.UI.toast('âœ¨ æ¨™è¨»æª¢æŸ¥å®Œæˆï¼'); }
            },
            smartHighlight: () => {
                const editor = App.Dom.editor;
                const kws = App.Dom.kw.value.split('\n').filter(k => k.trim());
                editor.querySelectorAll('b[data-auto="true"]').forEach(mark => {
                    const text = document.createTextNode(mark.textContent);
                    mark.parentNode.replaceChild(text, mark);
                });
                editor.normalize();
                if (kws.length === 0) { App.UI.updateStats(); return; }
                const walk = (node) => {
                    if (node.nodeType === 3) {
                        const text = node.nodeValue;
                        let bestMatch = null;
                        kws.forEach(kw => {
                            const idx = text.toLowerCase().indexOf(kw.toLowerCase());
                            if (idx !== -1) {
                                if (!bestMatch || idx < bestMatch.idx || (idx === bestMatch.idx && kw.length > bestMatch.len)) {
                                    bestMatch = { idx, len: kw.length, str: kw };
                                }
                            }
                        });
                        if (bestMatch) {
                            const matchText = text.substr(bestMatch.idx, bestMatch.len);
                            const afterText = node.splitText(bestMatch.idx + bestMatch.len);
                            const middleNode = node.splitText(bestMatch.idx);
                            const b = document.createElement('b');
                            b.setAttribute('data-auto', 'true');
                            b.style.color = '#BF1E33';
                            b.textContent = middleNode.nodeValue;
                            middleNode.parentNode.replaceChild(b, middleNode);
                            walk(afterText); 
                        }
                    } else if (node.nodeType === 1 && node.childNodes && !['SCRIPT', 'STYLE'].includes(node.tagName)) {
                        Array.from(node.childNodes).forEach(walk);
                    }
                };
                walk(editor);
                App.Core.analyzeDensity(); 
                App.UI.updateStats(); 
                App.Storage.save('fluo_temp', editor.innerHTML);
            },
            restore: () => { if(confirm('ç¢ºå®šè¦é‚„åŸé è¦½å€ï¼Ÿ')) { App.state.isAutoSync=true; App.Core.runSync(); }},
            bakeStyles: (rootNode) => {
                const bake = (node) => {
                    if (node.nodeType === 1) { 
                        const style = window.getComputedStyle(node);
                        if (node.style.color && node.style.color.includes('var(')) { const v = node.style.color.match(/var\(([^)]+)\)/)[1]; if (Config.colors[v]) node.style.color = Config.colors[v]; }
                        const isBold = (parseInt(style.fontWeight) >= 700) || ['H2','H3','B','STRONG'].includes(node.tagName);
                        node.style.fontWeight = isBold ? '700' : '400';
                        node.style.lineHeight = "1.0"; 
                        node.style.marginBottom = "12pt"; 
                        node.style.fontFamily = "'Microsoft JhengHei', 'Noto Sans TC', sans-serif";

                        if(node.tagName === 'H2') { 
                            node.style.fontSize="18pt"; node.style.fontWeight="700"; node.style.color="#2B4B65"; 
                            node.style.lineHeight="1.2"; node.style.borderBottom="1px solid #DDD"; node.style.paddingBottom="4px";
                        }
                        if(node.tagName === 'H3') { 
                            node.style.fontSize="14pt"; node.style.fontWeight="700"; node.style.color="#333"; 
                            node.style.lineHeight="1.2"; node.style.borderLeft="4px solid #BF1E33"; node.style.paddingLeft="8px"; 
                        }
                        if(node.tagName === 'P') { node.style.fontSize = "12pt"; node.style.lineHeight = "1.0"; }
                    }
                    node.childNodes.forEach(bake);
                };
                bake(rootNode);
            },
            handleManualCopy: (e) => {
                const sel = window.getSelection();
                if (sel.rangeCount === 0) return;
                e.preventDefault(); 
                const range = sel.getRangeAt(0);
                const div = document.createElement('div');
                div.appendChild(range.cloneContents());
                App.Core.bakeStyles(div);
                const wrapper = document.createElement('div');
                wrapper.style.cssText = "font-family: 'Microsoft JhengHei', 'Noto Sans TC', sans-serif; font-size: 12pt; font-weight: 400; line-height: 1.0; color: #333; background: white;";
                wrapper.appendChild(div);
                if (e.clipboardData) { e.clipboardData.setData('text/html', wrapper.outerHTML); e.clipboardData.setData('text/plain', sel.toString()); }
                App.UI.toast('âœ¨ å·²è¤‡è£½åˆ°å‰ªè²¼ç°¿');
            },
            copyToDocs: async () => {
                const wrapper = document.createElement('div');
                wrapper.style.cssText = "font-family: 'Microsoft JhengHei', 'Noto Sans TC', sans-serif; font-size: 12pt; font-weight: 400; line-height: 1.0; color: #333; background: white;";
                const clone = App.Dom.editor.cloneNode(true);
                App.Core.bakeStyles(clone);
                wrapper.innerHTML = clone.innerHTML;
                try { 
                    await navigator.clipboard.write([new ClipboardItem({'text/html': new Blob([wrapper.outerHTML],{type:'text/html'}), 'text/plain': new Blob([App.Dom.editor.innerText],{type:'text/plain'})})]); 
                    App.UI.toast('âœ¨ å·²è¤‡è£½ï¼(Docs æ ¼å¼é–å®š)'); 
                } catch(e) { App.UI.toast('âŒ è¤‡è£½å¤±æ•—'); }
            }
        },
        Format: {
            cmd: (c, v) => { document.execCommand(c, false, v); App.state.isAutoSync=false; App.UI.updateStats(); },
            setSize: (pt) => { const sel = window.getSelection(); if (sel.isCollapsed) return App.UI.toast('âš ï¸ è«‹å…ˆé¸å–æ–‡å­—'); document.execCommand('fontSize', false, '7'); App.Dom.editor.querySelectorAll('font[size="7"]').forEach(el => { el.removeAttribute('size'); el.style.fontSize = pt; }); App.state.isAutoSync=false; },
            stepSize: (step) => { const sel = window.getSelection(); if (sel.isCollapsed) return App.UI.toast('âš ï¸ è«‹å…ˆé¸å–æ–‡å­—'); let cur = 12; if(sel.anchorNode.parentElement.tagName === 'SPAN' && sel.anchorNode.parentElement.style.fontSize) cur = parseInt(sel.anchorNode.parentElement.style.fontSize); else { const c = window.getComputedStyle(sel.anchorNode.parentElement).fontSize; if(c) cur = Math.round(parseFloat(c)*0.75); } let newSize = 12; if (step > 0) { const next = Config.fontScale.find(s => s > cur); newSize = next ? next : Config.fontScale[Config.fontScale.length - 1]; } else { const prev = [...Config.fontScale].reverse().find(s => s < cur); newSize = prev ? prev : Config.fontScale[0]; } const sizeStr = newSize + 'pt'; App.Format.setSize(sizeStr); App.Dom.fontSelect.value = sizeStr; },
            color: (c) => App.Format.cmd('foreColor', c), highlight: (c) => { document.execCommand('hiliteColor', false, c) || document.execCommand('backColor', false, c); App.state.isAutoSync=false; },
            removeColor: () => { document.execCommand('foreColor', false, '#333333'); App.state.isAutoSync=false; },
            removeHighlight: () => { document.execCommand('backColor', false, 'transparent'); App.state.isAutoSync=false; },
            remove: () => { App.Format.cmd('removeFormat'); App.Format.cmd('backColor', 'transparent'); }
        },
        UI: {
            updateStats: () => { const t = App.Dom.editor.innerText || ''; const c = App.state.includePunctuation ? t : t.replace(/[^\w\u4e00-\u9fa5]/g, ''); App.Dom.countTotal.innerText = c.replace(/[\n\r]/g, '').length; const s = window.getSelection().toString(); App.Dom.countSel.innerText = App.state.includePunctuation ? s.length : s.replace(/[^\w\u4e00-\u9fa5]/g, '').length; const m = document.getElementById('mobileFloatMenu'); if(window.innerWidth < 768 && s.length > 0) { m.classList.add('show'); m.style.top = '100px'; m.style.left = '50%'; m.style.transform = 'translateX(-50%)'; } else { m.classList.remove('show'); } },
            showSaved: () => { App.Dom.saveStatus.style.opacity = '1'; setTimeout(() => { App.Dom.saveStatus.style.opacity = '0'; }, 1500); },
            togglePunctuation: () => { App.state.includePunctuation = !App.state.includePunctuation; App.Dom.puncDot.className = App.state.includePunctuation ? "w-2 h-2 rounded-full bg-green-500" : "w-2 h-2 rounded-full bg-gray-300"; App.UI.updateStats(); },
            switchMobileTab: (tab) => {
                const input = document.getElementById('tabInput'); const preview = document.getElementById('tabPreview');
                const btnInput = document.getElementById('tabBtnInput'); const btnPreview = document.getElementById('tabBtnPreview');
                if(tab==='input'){ 
                    input.classList.remove('hidden-mobile'); input.classList.add('flex-mobile'); 
                    preview.classList.remove('flex-mobile'); preview.classList.add('hidden-mobile'); 
                    btnInput.classList.add('active'); btnPreview.classList.remove('active'); 
                } else { 
                    input.classList.remove('flex-mobile'); input.classList.add('hidden-mobile'); 
                    preview.classList.remove('hidden-mobile'); preview.classList.add('flex-mobile'); 
                    btnInput.classList.remove('active'); btnPreview.classList.add('active'); 
                }
            },
            toggleTheme: () => { const isDark = document.body.getAttribute('data-theme') === 'dark'; document.body.setAttribute('data-theme', isDark ? 'light' : 'dark'); localStorage.setItem('fluo_theme', isDark ? 'light' : 'dark'); },
            toggleZenMode: () => { document.body.classList.toggle('zen-mode'); const isZen = document.body.classList.contains('zen-mode'); localStorage.setItem('fluo_zen', isZen); App.UI.toast(isZen ? 'Zen Mode é–‹å•Ÿ' : 'Zen Mode é—œé–‰'); },
            // ğŸŸ¢ UX: Toast å¯¦ä½œ
            toast: (msg) => {
                const c = document.getElementById('toastContainer');
                const t = document.createElement('div'); t.className = 'toast'; t.innerHTML = msg;
                c.appendChild(t);
                requestAnimationFrame(() => t.classList.add('show'));
                setTimeout(() => { t.classList.remove('show'); setTimeout(() => t.remove(), 300); }, 2000);
            }
        }
    };
    window.App = App;
    document.addEventListener('DOMContentLoaded', App.Init);
  </script>
</body>
</html>
